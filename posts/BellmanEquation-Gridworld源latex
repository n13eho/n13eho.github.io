---
title: "Bellman Equation: Gridworld"
subtitle: ""
date: 2022-12-01T16:50:23+08:00
draft: false

summary: "--"

tags: [BellmanEquation, RL]
categories: [ML]

hiddenFromHomePage: false
hiddenFromSearch: false

featuredImage: ""
featuredImagePreview: ""

license: '<a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a>'
---

## é—®é¢˜æè¿°

æ¸¸æˆè§„åˆ™ï¼šæ­£å¸¸ç§»åŠ¨ä¸€æ¬¡çš„å¥–åŠ±ä¸º0ï¼›å‡ºç•Œæ—¶å›åˆ°å½“å‰ä½ç½®ï¼Œå¥–åŠ±ä¸º-1ï¼›Aä½ç½®é€‰æ‹©ä»»æ„æ–¹å‘éƒ½åˆ°è¾¾Aâ€™ï¼Œå¥–åŠ±ä¸º+10ï¼›Bä½ç½®é€‰æ‹©ä»»æ„æ–¹å‘éƒ½åˆ°è¾¾Bâ€™ï¼Œå¥–åŠ±ä¸º+5ï¼› æŠ˜æ‰£ç‡y = 0.9ã€‚

å‡å®šç­–ç•¥ä¸ºï¼›ä»æ¯ä¸ªæ ¼å­ç­‰æ¦‚ç‡é€‰æ‹©å››ä¸ªç§»åŠ¨æ–¹å‘ ï¼ˆè¡Œä¸ºï¼‰

![](https://nehopicbed.oss-cn-beijing.aliyuncs.com/img/202212012302219.png)

ç”¨Bellman Equationå¤ç°å³è¾¹5*5çš„çŠ¶æ€ä¼°å€¼

## è§£

è®°å·è§„å®šï¼šobjç§»åŠ¨åˆ°å·¦ä¸Šè§’çš„çŠ¶æ€ï¼šs(0, 0)/s(0)ï¼Œç§»åŠ¨åˆ°å³ä¸‹è§’çš„çŠ¶æ€ï¼šs(4, 4)/s(24)

å¸¦å…¥Bellman Equationï¼š

$$
v_{\pi}(s) = \sum_{a}\pi(a|s)\sum_{s', r}p(s', r|s, a)[r + \gamma v_{\pi}s']
$$

å¯¹äºåœ¨ä½ç½®(0, 0)çš„çŠ¶æ€ï¼š

$$
\begin{align}
v_{\pi}(0) =
 &\frac{1}{4}\sum_{s', r}p(s', r|s, a)[r + \gamma v_{\pi}(1)]\quadå‘å³èµ°\\
+&\frac{1}{4}\sum_{s', r}p(s', r|s, a)[r + \gamma v_{\pi}(ğŸ˜«)]\quadå‘å·¦èµ°\\
+&\frac{1}{4}\sum_{s', r}p(s', r|s, a)[r + \gamma v_{\pi}(5)]\quadå‘ä¸‹èµ°\\
+&\frac{1}{4}\sum_{s', r}p(s', r|s, a)[r + \gamma v_{\pi}(ğŸ˜«)]\quadå‘ä¸Šèµ°\\


\end{align}
$$

å¯¹äºè¿™é‡Œçš„

$$
\sum_{s', r}p(s', r|s, a)[r + \gamma v_{\pi}(s')]
$$

é™¤äº†ç‰¹æ®Šä½ç½®Aå’ŒBå¤–ï¼Œå…¶ä½™éƒ½æ˜¯`0 * [] + 0 * [] + 0 * [] + 1 * [0 + 0.9 * ä¸‹ä¸€ä¸ªçŠ¶æ€çš„ä¼°å€¼]`ï¼Œæ‰€ä»¥å¯¹äºä½ç½®(0, 0)ï¼š

$$
\begin{align}
v_{\pi}(0) =
 &\frac{1}{4}[0 + 0.9  v_{\pi}(1)]\quadå‘å³èµ°\\
+&\frac{1}{4}[-1 + 0.9 v_{\pi}(0)]\quadå‘å·¦èµ°\\
+&\frac{1}{4}[0 + 0.9 v_{\pi}(5)]\quadå‘ä¸‹èµ°\\
+&\frac{1}{4}[-1 + 0.9 v_{\pi}(0)]\quadå‘ä¸Šèµ°\\
\end{align}
$$

$$
v_{\pi}(0) = \frac{9}{40}v_{\pi}(1) + \frac{9}{20}v_{\pi}(0) + \frac{9}{40}v_{\pi}(5) -\frac{1}{2}
$$

ä»¥æ­¤ç±»æ¨å…¶ä½™åœ°æ–¹çš„ç‚¹éƒ½ä¸€æ ·ï¼Œé™¤äº†Aç‚¹s(1)å’ŒBç‚¹s(3)

$$
\begin{align}
v_{\pi}(1) &= 10 + 0.9v_{\pi}(21)\\
v_{\pi}(3) &= 5 + 0.9v_{\pi}(13)
\end{align}
$$

ç„¶åå°±æ˜¯matlab codingå¾—è§£ï¼š

```matlab
syms v0 v1 v2 v3 v4 v5 v6 v7 v8 v9 v10 v11 v12 v13 v14 v15 v16 v17 v18 v19 v20 v21 v22 v23 v24;

eqns=[
    v0 == (9 / 40) * v1 + 9 / 20 * v0 + (9 / 40) * v5 - 0.5,
    v1 == 10 + 0.9 * v21,
    v2 == (9 / 40) * (v3 + v1 + v2 + v7) - 0.25,
    v3 == 5 + 0.9 * v13,
    v4 == (9 / 40) * (v3 + v9 + 2 * v4) - 0.5,
    v5 == (9 / 40) * (v5 + v6 + v0 + v10) - 0.25,
    v6 == (9 / 40) * (v1 + v5 + v7 + v11),
    v7 == (9 / 40) * (v2 + v6 + v8 + v12),
    v8 == (9 / 40) * (v3 + v7 + v9 + v13),
    v9 == (9 / 40) * (v4 + v8 + v9 + v14) - 0.25,
    v10 == (9 / 40) * (v5 + v10 + v11 + v15) - 0.25,
    v11 == (9 / 40) * (v6 + v10 + v12 + v16),
    v12 == (9 / 40) * (v7 + v11 + v13 + v17),
    v13 == (9 / 40) * (v8 + v12 + v14 + v18),
    v14 == (9 / 40) * (v9 + v13 + v14 + v19) - 0.25,
    v15 == (9 / 40) * (v15 + v10 + v16 + v20) - 0.25,
    v16 == (9 / 40) * (v11 + v15 + v17 + v21),
    v17 == (9 / 40) * (v12 + v16 + v18 + v22),
    v18 == (9 / 40) * (v13 + v17 + v19 + v23),
    v19 == (9 / 40) * (v14 + v18 + v19 + v24) - 0.25,
    v20 == (9 / 40) * (v15 + v21 + 2 * v20) - 0.5,
    v21 == (9 / 40) * (v16 + v20 + v21 + v22) - 0.25,
    v22 == (9 / 40) * (v17 + v21 + v22 + v23) - 0.25,
    v23 == (9 / 40) * (v18 + v22 + v23 + v24) - 0.25,
    v24 == (9 / 40) * (v19 + v23 + 2 * v24) - 0.5,
    ]; 
vars=[v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15, v16, v17, v18, v19, v20, v21, v22, v23, v24];
ret=solve(eqns,vars);
ret = [
[roundn(double(ret.v0),-1), roundn(double(ret.v1),-1) ,roundn(double(ret.v2),-1), roundn(double(ret.v3),-1), roundn(double(ret.v4),-1)],
[roundn(double(ret.v5),-1), roundn(double(ret.v6),-1) ,roundn(double(ret.v7),-1), roundn(double(ret.v8),-1), roundn(double(ret.v9),-1)],
[roundn(double(ret.v10),-1), roundn(double(ret.v11),-1) ,roundn(double(ret.v12),-1), roundn(double(ret.v13),-1), roundn(double(ret.v14),-1)],
[roundn(double(ret.v15),-1), roundn(double(ret.v16),-1) ,roundn(double(ret.v17),-1), roundn(double(ret.v18),-1), roundn(double(ret.v19),-1)],
[roundn(double(ret.v20),-1), roundn(double(ret.v21),-1) ,roundn(double(ret.v22),-1), roundn(double(ret.v23),-1), roundn(double(ret.v24),-1)]
]

```

ä½†æ˜¯ç»“æœå‡ºæ¥ret.v0=211544423854643298169167140/63930087070970054436332951ï¼ŒGå•Šï¼Œå’‹å›äº‹ï¼Ÿ

---

å™¢å™¢çœ‹é”™äº†ï¼Œæ˜¯å¯¹çš„ï¼Œä¸­é—´è¿˜æœ‰ä¸ªé™¤å·ï¼Œä¸‹é¢æ˜¯æœ€åçš„ç»“æœï¼š

![](https://nehopicbed.oss-cn-beijing.aliyuncs.com/img/202212020129949.png)

å¯¹å¾—ä¸Š